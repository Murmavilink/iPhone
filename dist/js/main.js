(()=>{"use strict";const e=(e,t)=>{const r=document.querySelector(".modal"),c=r.querySelector(".modal__title"),l=e=>{r.style.display=e};e.addEventListener("click",(()=>{l("flex"),c.textContent=t.textContent})),r.addEventListener("click",(e=>{!e.target.classList.contains("modal__close")&&e.target.closest(".modal__block")||l("none")}))},t=e=>{let t=!1;for(let t=0;t<e.length;t++)e[t].value.trim().length<2?e[t].classList.add("error"):e[t].classList.remove("error"),e[t].classList.contains("form-phone")&&e[t].value.trim().length<18&&e[t].classList.add("error");for(let r=0;r<e.length;r++){if(e[r].classList.contains("error"))return!1;e[r].classList.contains("error")||(t=!0)}return t};[...document.querySelectorAll(".header-menu a"),document.querySelector(".card-details__link-characteristics")].forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();let r=e.getAttribute("href").substring(1),c=document.getElementById(r);c&&c.scrollIntoView({block:"center",behavior:"smooth"})}))})),(()=>{const e=document.querySelectorAll(".header-menu__item"),t=document.querySelector(".header-menu__burger"),r=document.createElement("div");r.classList.add("burger-list");const c=()=>{r.classList.toggle("burger-list--open")};document.addEventListener("click",(l=>{l.target.classList.contains("header-menu__burger")&&(e.forEach((e=>{e.style.whiteSpace="normal",r.append(e)})),t.append(r),c()),(l.target.matches(".header-menu__item > a")||r.classList.contains("burger-list--open")&&!l.target.closest(".header-menu__burger"))&&c()}))})(),(()=>{const t=document.querySelectorAll(".card-detail__change"),r=document.querySelector(".card-details__title"),c=document.querySelector(".card-details__price"),l=document.querySelector(".card__image_item"),s=document.querySelector(".card-details__description-list"),o=[{name:"Смартфон Apple iPhone 13 Pro 128GB Graphite",color:"Graphite",memory:"128",price:65e3,image:"img/iPhone-graphite.webp",description:'Характеристики: ОС iOS 15, Тип корпуса: классический, Экран: 6.1", Оперативная память: 6 Гб, Встроенная память: 128Гб, SIM: 1 SIM, Основная камера: 12 Mpx, Количество модулей камеры: 3, Фронтальная камера: 12Mpx, Аккумулятор: 3125 мАч, сенсорный экран, поддержка 4G, поддержка 5G, NFC, Bluetooth, Wi-Fi, GPS, Сканер лица, Быстрая зарядка, Беспроводная зарядка'},{name:"Смартфон Apple iPhone 13 Pro Max 256GB Silver",color:"Silver",memory:"256",price:72e3,image:"img/iPhone-silver.webp",description:'Характеристики: ОС iOS 15, Тип корпуса: классический, Экран: 6.7", Оперативная память: 6 Гб, Встроенная память: 256Гб, SIM: 1 SIM, Основная камера: 12 Mpx, Количество модулей камеры: 3, Фронтальная камера: 12Mpx, Аккумулятор: 4373 мАч, сенсорный экран, поддержка 4G, поддержка 5G, NFC, Bluetooth, Wi-Fi, GPS, Сканер лица, Быстрая зарядка, Беспроводная зарядка'},{name:"Смартфон Apple iPhone 13 Pro 1TB Sierra Blue",color:"Sierra Blue",memory:"1TB",price:8e4,image:"img/iPhone-sierra_blue.webp",description:'Характеристики: ОС iOS 15, Тип корпуса: классический, Экран: 6.1", Оперативная память: 6 Гб, Встроенная память: 1024Гб, SIM: 1 SIM, Основная камера: 12 Mpx, Количество модулей камеры: 3, Фронтальная камера: 12Mpx, Аккумулятор: 3125 мАч, сенсорный экран, поддержка 4G, поддержка 5G, NFC, Bluetooth, Wi-Fi, GPS, Сканер лица, Быстрая зарядка, Беспроводная зарядка'}],n=(e=0)=>{r.textContent=o[e].name,l.setAttribute("src",o[e].image),c.textContent=`${o[e].price} ₽`,s.textContent=o[e].description,document.title=`iPhone ${o[e].color}`};t.forEach(((e,r)=>{e.addEventListener("click",(c=>{t.forEach((e=>{e.classList.remove("active")})),e===c.target&&(e.classList.add("active"),n(r))}))})),(()=>{const t=document.querySelector(".card-details__button_delivery"),r=document.querySelector(".card-details__title");e(t,r)})(),n(0)})(),document.querySelector(".characteristics__list").addEventListener("click",(e=>{if(e.target.classList.contains("characteristics__title")){const t=e.target.nextElementSibling;e.target.classList.toggle("active"),e.target.classList.contains("active")?t.style.height=t.scrollHeight+"px":t.style.height=0}})),(()=>{const e=document.querySelector(".cross-sell__list"),t=document.querySelector(".cross-sell__add");let r=1;const c=async()=>{try{const c=await fetch("https://iphonedb-691a5-default-rtdb.firebaseio.com/goodsApple.json");(c=>{const l=4*r;var s;s=c.slice(0,l),e.textContent="",s.forEach((t=>{e.insertAdjacentHTML("beforeend",`\n            <li>\n                <article class="cross-sell__item">\n                    <img class="cross-sell__image" src="./${t.photo}">\n                    <h3 class="cross-sell__title">${t.name}</h3>\n                    <p class="cross-sell__price">${t.price} ₽</p>\n                    <button type="button" class="button button-basket cross-sell__button">В карзину</button>\n                </article>\n            </li>\n            `)})),c.length>l?r++:t.remove()})(await c.json())}catch(e){console.log(e)}};c(),t.addEventListener("click",c)})(),(()=>{const e=document.querySelector(".modal__block"),r=e.querySelector(".modal__form"),c=e.querySelectorAll(".modal__label"),l=e.querySelectorAll(".modal__input"),s={},o=document.createElement("p");o.classList.add("status-block");const n=()=>{setTimeout((()=>{o.style="",o.textContent=""}),5e3)};r.addEventListener("input",(e=>{t(l)})),r.addEventListener("submit",(a=>{var i;a.preventDefault(),t(l)&&(c.forEach((e=>{const t=e.querySelector("span"),r=e.querySelector("input");s[t.textContent]=r.value})),s.title=r.querySelector(".modal__title").textContent,e.append(o),o.textContent="Загрузка...",i=s,fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify(i),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((e=>{o.style.color="green",o.textContent="Успешно отправлено",n()})).catch((e=>{o.style.color="red",o.textContent="Ошибка!",n()})),l.forEach((e=>{e.value=""})))})),((e,t="+7 (___) ___-__-__")=>{const r=document.querySelectorAll(e),c=e=>{const{keyCode:r,target:c}=e,l=t,s=l.replace(/\D/g,""),o=c.value.replace(/\D/g,"");let n=0,a=l.replace(/[_\d]/g,(e=>n<o.length?o.charAt(n++)||s.charAt(n):e));n=a.indexOf("_"),-1!==n&&(a=a.slice(0,n));let i=l.substr(0,c.value.length).replace(/_+/g,(({length:e})=>`\\d{1,${e}}`)).replace(/[+()]/g,"\\$&");i=new RegExp(`^${i}$`),(!i.test(c.value)||c.value.length<5||r>47&&r<58)&&(c.value=a),"blur"==e.type&&c.value.length<5&&(c.value="")};for(const e of r)e.addEventListener("input",c),e.addEventListener("focus",c),e.addEventListener("blur",c)})(".form-phone"),document.querySelector(".form-name").addEventListener("input",(e=>{e.target.value=e.target.value.replace(/[^а-яё -]/i,"")}))})(),(()=>{const t=document.querySelector(".cross-sell__list"),r=document.querySelector(".basket"),c=document.querySelector(".basket__inner"),l=document.querySelector(".cart"),s=JSON.parse(localStorage.getItem("products"))||[],o=()=>{localStorage.setItem("products",JSON.stringify(s))},n=()=>{c.innerHTML="",s.forEach((e=>{c.insertAdjacentHTML("beforeend",`\n                <article class="basket__item">\n                    <img class="basket__image" src="${e.image}">\n                    <h3 class="basket__title">${e.title}</h3>\n                    <p class="basket__price">${e.price}</p>\n                    <button type="button" class="basket__btn button-buy">Купить</button>\n                    <button type="button" class="basket__btn button-reomve">Удалить</button>\n                </article>\n                `)})),a(),i()};t.addEventListener("click",(e=>{if(e.target.classList.contains("button-basket")){const t={},r=e.target.closest(".cross-sell__item"),c=r.querySelector(".cross-sell__image"),l=r.querySelector(".cross-sell__title"),o=r.querySelector(".cross-sell__price");t.image=c.getAttribute("src"),t.title=l.textContent,t.price=o.textContent,s.forEach(((e,t)=>{e.title==l.textContent&&s.splice(t,1)})),s.push(t)}o(),n()}));const a=()=>{const t=c.querySelectorAll(".button-buy"),a=c.querySelectorAll(".basket__title"),i=c.querySelectorAll(".button-reomve");t.forEach(((t,r)=>{e(t,a[r])})),i.forEach(((e,t)=>{e.addEventListener("click",(()=>{s.splice(t,1),o(),n(),0===s.length&&(r.classList.remove("active"),l.classList.remove("active"))}))}))},i=()=>{s.length>0&&l.classList.add("active")};l.addEventListener("click",(()=>{r.classList.toggle("active")})),i(),n()})()})();